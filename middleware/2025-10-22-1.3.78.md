---
authors: poscreator
slug: middleware/1.3.78
tags: [Middleware, Germany, Austria, Denmark, Belgium, Portugal, Greece, Italy]
---

# Middleware 1.3.78
[![Static Badge](https://img.shields.io/badge/milestone-v1.3.78-green?logo=github)](https://github.com/fiskaltrust/middleware/milestone/10?closed=1)

In this version of the Middleware, we focused on stability improvements, security updates, and preparatory work for additional European markets.  
This release includes important updates for the **German** and **Austrian** markets, as well as groundwork for **Portugal (PT)**, **Greece (GR)**, **Denmark (DK)**, and **Belgium (BE)**.

Version 1.3 of the Middleware is intended primarily for the **German** and **Italian** markets,  
with ongoing preparation for **Austria**, **Portugal**, **Greece**, **Denmark**, and **Belgium**.  

## Feature: Updated Code Signing in Storage Pipeline ([fiskaltrust/middleware#526](https://github.com/fiskaltrust/middleware/pull/526))

We have modernized the code signing process used in the storage pipeline to align with current security and compliance standards.  
The previous implementation relied on a simple `codesigning@2` task. With this update, the signing workflow now uses **DigiCert Signing Manager** with **Hardware Security Module (HSM)** support.

This change improves security, traceability, and reliability of signed artifacts during the build and release process. It also introduces enhanced error handling and more detailed logging to simplify troubleshooting in CI/CD environments.

### Affected components:
- _fiskaltrust.Middleware.Storage Pipeline_

## 🇩🇪 Feature: Updated DSFinV-K Export Package ([fiskaltrust/middleware#518](https://github.com/fiskaltrust/middleware/pull/518))

We have updated the **DSFinV-K export component** used by the Middleware to version **1.6.9**.  
This update ensures compatibility with the latest official specifications and improves overall export stability and consistency for fiscal data submissions in Germany.

## Feature: Prepared Interface and Storage for PT, GR, DK, and BE ([fiskaltrust/middleware#523](https://github.com/fiskaltrust/middleware/pull/523))

We extended the Middleware to prepare for upcoming market implementations in **Portugal (PT)**, **Greece (GR)**, **Denmark (DK)**, and **Belgium (BE)**.  
This includes adding country-specific queue and SCU models (`ftQueueXX` and `ftSignaturCreationUnitXX`) to the storage layer, updating configuration repositories, and introducing new `IXXSSCD` interfaces in the shared interface package.

These foundational changes enable further development and certification work for the new fiscal markets.

### Affected components:
- _fiskaltrust.Middleware.Storage_
- _fiskaltrust.Middleware.Interface_

## CI: Updated Code Signing Configuration ([fiskaltrust/middleware#527](https://github.com/fiskaltrust/middleware/pull/527))

Updated the CI pipeline configuration to align with the new code signing process and ensure consistent signing across all middleware builds.

## 🇮🇹 Feature: Added Support for Unreferenced Refunds with Epson RT Printers ([fiskaltrust/middleware#515](https://github.com/fiskaltrust/middleware/pull/515))

With this release, we’ve added support for **unreferenced refunds** when using **Epson RT Printer-based SCUs**.  
This enhancement makes it possible to process refunds even when the original receipt reference is unavailable (e.g., when the original document was lost).

While we still recommend using referenced refunds in most scenarios, this feature ensures full refund support across all Italian SCUs.

## 🇩🇪: Updated DSFinV-K Export Package ([fiskaltrust/middleware#536](https://github.com/fiskaltrust/middleware/pull/536))

The Middleware now references version **1.6.10** of the `fiskaltrust.Exports.DSFinVK` package, ensuring compatibility with the latest German DSFinV-K export requirements.

## 🇩🇪 Feature: Improved Handling of Open Transactions During Daily Closing ([fiskaltrust/middleware#545](https://github.com/fiskaltrust/middleware/pull/545))

We improved how open transactions are processed and represented during **daily closing** operations.  
The Middleware now consistently treats open transactions as empty lists instead of null values, increasing reliability and stability of the daily closing process across both production and test environments.

### Affected packages:
- _fiskaltrust.Middleware.Queue.DE_
- _fiskaltrust.Middleware.SCU.DE_

## 🇩🇪 Feature: Improved Daily Closing and SwissbitCloudV2 Storage Handling ([fiskaltrust/middleware#538](https://github.com/fiskaltrust/middleware/pull/538))

We improved the **daily closing process** by ensuring all open transactions on the TSE are properly closed and standardized their handling across the codebase.  
Additionally, the **SwissbitCloudV2 SCU** now includes enhanced error handling for full storage scenarios, improving reliability and system feedback in edge cases.

### Affected packages:
- _fiskaltrust.Middleware.SCU.DE.SwissbitCloudV2_
- _fiskaltrust.Middleware.Queue.DE_

## 🇦🇹 Fix: Improved Backup SCU Handling ([fiskaltrust/middleware#483](https://github.com/fiskaltrust/middleware/pull/483))

We refined how **backup Signature Creation Units (SCUs)** are selected and used in the Austrian market.  
The updated logic ensures that normal SCUs are prioritized and that the system reliably falls back to a backup SCU only when necessary, improving overall signing stability and resilience.

## 🇩🇪 Fix: Corrected Public Key Handling for SwissbitCloudV2 SCU ([fiskaltrust/middleware#503](https://github.com/fiskaltrust/middleware/pull/503))

We simplified and improved how the **TSE public key** is managed in the SwissbitCloudV2 SCU.  
The public key is now retrieved directly from the TSE response instead of being parsed from the certificate chain, ensuring correct QR code generation and reducing potential parsing errors.

### Affected packages:
- _fiskaltrust.Middleware.SCU.DE.SwissbitCloudV2_

## 🇩🇪 Feature: Improved SCU Switch Validation ([fiskaltrust/middleware#525](https://github.com/fiskaltrust/middleware/pull/525))

We improved the validation logic for **SCU switching** in the `FinishScuSwitchReceiptCommand`.  
The Middleware now verifies that the target SCU ID from the initiation receipt matches the current SCU ID, ensuring consistent and reliable switching — and allowing the SCU registration process to be safely repeated when needed.

### Affected packages:
- _fiskaltrust.Middleware.Queue.DE_

## 🇦🇹 Feature: Create One Instance of ATSSCDProvider ([fiskaltrust/middleware#539](https://github.com/fiskaltrust/middleware/pull/539))

We refactored the **ATSSCD provider** to ensure only a single shared instance is created and used across the Middleware.  
This change improves initialization logic, thread safety, and asynchronous handling, leading to more reliable and performant SCU operations.

### Affected packages:
- _fiskaltrust.Middleware.Queue.AT_
- _fiskaltrust.Middleware.SCU.AT_




