---
authors: poscreator
slug: middleware/1.3.81
tags: [Middleware, Germany, Greece]
---
# Middleware 1.3.81
[![Static Badge](https://img.shields.io/badge/milestone-v1.3.81-green?logo=github)](https://github.com/fiskaltrust/middleware/milestone/13?closed=1)

This release includes important bug fixes and improvements for the **German** and **Greek** markets.
We've fixed critical issues with certificate validation in SwissbitCloud V2, improved correlation handling for Greek retail credit notes, enhanced reliability for FiskalyCertified TSE operations, and resolved an error handling bug that affected all queues.

:::info

Version 1.3 of the Middleware is intended for the German and Italian markets only (with Belgium, Denmark, Greece, Portugal, and Spain currently in development).
Customers in Austria and France should continue to use version 1.2.
A preview of the unified 1.3 Middleware for Austria and France is already available.

:::

## ðŸ‡©ðŸ‡ª Bug Fix: Fixed Certificate Validation Error in SwissbitCloud V2 ([fiskaltrust/middleware#615](https://github.com/fiskaltrust/middleware/pull/615))

This update resolves a certificate validation error that occurred when using the SwissbitCloud V2 SCU.
The certificate chain data is now correctly formatted and no longer causes validation failures, ensuring reliable signature operations and TSE communication.

### Affected packages:
- _fiskaltrust.Middleware.SCU.DE.SwissbitCloudV2_

## ðŸ‡¬ðŸ‡· Bug Fix: Retail credit notes now properly correlate with original receipts ([fiskaltrust/middleware#601](https://github.com/fiskaltrust/middleware/pull/601))

Retail credit notes (invoice type 11.4) previously did not correlate properly with their original receipts when using the MyDATA SCU.
This has been fixed to ensure that when you issue a retail credit note referencing a previous receipt (using `cbPreviousReceiptReference`), the system now correctly uses the `multipleConnectedMarks` field to link the credit note to the original document in the Greek MyDATA system.
This ensures proper tracking and compliance with Greek fiscal regulations for retail refunds and returns.
Unreferenced refunds (refunds without a previous receipt reference) continue to be supported as before.

### Affected packages:
- _fiskaltrust.Middleware.SCU.GR.MyData_

## ðŸ‡©ðŸ‡ª Improvement: Enhanced reliability for FiskalyCertified TSE with Retry-After handling ([fiskaltrust/middleware#600](https://github.com/fiskaltrust/middleware/pull/600))

The fiskaltrust Middleware now respects the `Retry-After` header returned by the fiskaly cloud TSE service when it is experiencing high load.
Previously, when fiskaly's service returned error codes like 429 (Too Many Requests) or server errors (500-599), the Middleware would retry immediately using a fixed delay pattern, potentially causing additional strain on the service.
Now, when fiskaly indicates it needs time to recover and provides a specific wait time in the `Retry-After` header, the Middleware will wait exactly as long as requested before retrying the operation.
This results in more graceful handling of service overload situations, reducing failed requests and improving overall system stability.
Additionally, Zero receipts now include TSE information in their action journals for better traceability.

### Affected packages:
- _fiskaltrust.Middleware.Queue.AzureTableStorage_
- _fiskaltrust.Middleware.Queue.EF_
- _fiskaltrust.Middleware.Queue.MySQL_
- _fiskaltrust.Middleware.Queue.SQLite_
- _fiskaltrust.Middleware.SCU.DE.FiskalyCertified_

## Bug Fix: Fixed incorrect success response when uncaught exceptions occur ([fiskaltrust/middleware#586](https://github.com/fiskaltrust/middleware/pull/586))

This update resolves a critical issue where the Middleware incorrectly returned a success status when unexpected errors occurred during receipt processing.
Previously, when an uncaught exception happened, the system would not properly mark the operation as failed, potentially leading to incorrect status reporting.
With this fix, all uncaught exceptions are now correctly logged and the response is properly marked with an error state, ensuring accurate operation status reporting and improving system reliability.

### Affected packages:
- _fiskaltrust.Middleware.Queue.AzureTableStorage_
- _fiskaltrust.Middleware.Queue.EF_
- _fiskaltrust.Middleware.Queue.MySQL_
- _fiskaltrust.Middleware.Queue.SQLite_
